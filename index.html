<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Team Calendar</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for the calendar iframe to make it responsive */
        .calendar-container iframe {
            width: 100%;
            height: 600px;
            border-radius: 0.5rem; /* 8px */
            border: 1px solid #777; /* Matching the iframe's border style */
        }
    </style>
</head>
<body class="bg-gray-900 text-white antialiased">

    <div class="container mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
        
        <!-- Header Section -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold tracking-tight text-white sm:text-5xl">Our Shared Calendar</h1>
            <p class="mt-4 text-lg text-gray-300">View upcoming events below or use the form to add a new event to your personal calendar.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-12">

            <!-- Left Column: Add Event Form -->
            <div class="lg:col-span-1">
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-semibold mb-6">Add Event to Your Calendar</h2>
                    <form id="addEventForm">
                        <div class="space-y-4">
                            <!-- Event Title -->
                            <div>
                                <label for="eventTitle" class="block text-sm font-medium text-gray-300">Event Title</label>
                                <input type="text" id="eventTitle" name="eventTitle" required
                                    class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <!-- Event Date -->
                            <div>
                                <label for="eventDate" class="block text-sm font-medium text-gray-300">Date</label>
                                <input type="date" id="eventDate" name="eventDate" required
                                    class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" style="color-scheme: dark;">
                            </div>
                            <!-- Start Time -->
                            <div>
                                <label for="eventStartTime" class="block text-sm font-medium text-gray-300">Start Time</label>
                                <input type="time" id="eventStartTime" name="eventStartTime" required
                                    class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" style="color-scheme: dark;">
                            </div>
                            <!-- End Time -->
                             <div>
                                <label for="eventEndTime" class="block text-sm font-medium text-gray-300">End Time</label>
                                <input type="time" id="eventEndTime" name="eventEndTime" required
                                    class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" style="color-scheme: dark;">
                            </div>
                            <!-- Event Description -->
                            <div>
                                <label for="eventDescription" class="block text-sm font-medium text-gray-300">Description</label>
                                <textarea id="eventDescription" name="eventDescription" rows="4"
                                    class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                            </div>
                        </div>
                        <!-- Submit Button -->
                        <div class="mt-6">
                            <button type="submit"
                                class="w-full inline-flex justify-center py-3 px-4 border border-transparent shadow-sm text-sm font-semibold rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500 transition-colors">
                                Generate 'Add to Calendar' Link
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Right Column: Embedded Calendar -->
            <div class="lg:col-span-2 calendar-container">
                <!-- User's Google Calendar Iframe -->
                <iframe src="https://calendar.google.com/calendar/embed?height=600&wkst=1&ctz=America%2FDenver&showPrint=0&title=Grandpa's%20Calendar%20&src=ODhlNDljZTNiMTFhZmU5MmM5MGZlMjMzNzVjMzExMjU0M2I0Mzc5YzA0OGFmMmU3MTIxZGFlYzQ0ODEwN2FiYUBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&src=ZTBmNDIwNDhkMjVmOGUxMGYyNWY2NzBlN2RiNTczMzJmMWE5Y2Q0N2M0NTQyZGFkMzNhMWY3MzNjZGYzNTRmNUBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&src=dDg4N29ibDQ0dWRuN25sazZzMmY1dDgyMHZjbWFkcGZAaW1wb3J0LmNhbGVuZGFyLmdvb2dsZS5jb20&color=%23616161&color=%23a79b8e&color=%23ad1457" style="border:solid 1px #777" width="800" height="600" frameborder="0" scrolling="no"></iframe>
            </div>
        </main>

    </div>

    <script>
        // Get the form element
        const eventForm = document.getElementById('addEventForm');

        // Add a submit event listener to the form
        eventForm.addEventListener('submit', function (event) {
            // Prevent the default form submission behavior
            event.preventDefault();

            // Get values from the form fields
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const startTime = document.getElementById('eventStartTime').value;
            const endTime = document.getElementById('eventEndTime').value;
            const description = document.getElementById('eventDescription').value;

            // --- Construct the Google Calendar URL ---
            
            // Google Calendar requires dates in 'YYYYMMDDTHHMMSS' format, in UTC.
            // We'll combine the date and time inputs and format them.
            const startDateTime = new Date(`${date}T${startTime}`);
            const endDateTime = new Date(`${date}T${endTime}`);

            // The toISOString() method returns a string in ISO format (YYYY-MM-DDTHH:mm:ss.sssZ), 
            // which we can clean up for the Google Calendar URL.
            const formatAsGoogleDate = (dateObj) => dateObj.toISOString().replace(/-|:|\.\d{3}/g, '');

            const googleStartDate = formatAsGoogleDate(startDateTime);
            const googleEndDate = formatAsGoogleDate(endDateTime);

            // Create the base URL
            const googleCalendarUrl = new URL('https://www.google.com/calendar/render');
            googleCalendarUrl.searchParams.append('action', 'TEMPLATE');
            googleCalendarUrl.searchParams.append('text', title);
            googleCalendarUrl.searchParams.append('dates', `${googleStartDate}/${googleEndDate}`);
            googleCalendarUrl.searchParams.append('details', description);
            // You could also add a location:
            // googleCalendarUrl.searchParams.append('location', 'Your Location Here');

            // Open the generated URL in a new tab
            window.open(googleCalendarUrl.toString(), '_blank');
        });
    </script>

</body>
</html>
